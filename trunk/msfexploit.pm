#!/usr/bin/env perl
use strict;
use warnings;

package msfexpolit;

sub new
{
	my @CVEs = ();
	my $class = shift;
	my $self = {
		_name => shift,
		_rank => "Unknown",
		_title => "",
		_CVE => \@CVEs,

	};

	bless $self, $class;
	return $self;

}

sub getName
{
	my ($self) = @_;
	return $self->{_name};
}

sub getRank
{
	my ($self) = @_;
	return $self->{_rank};
}

sub setRank
{
	my ($self, $rank) = @_;
	$self->{_rank} = $rank;
}

sub getTitle
{
	my ($self) = @_;
	return $self->{_title};
}

sub setTitle
{
	my ($self, $rank) = @_;
	$self->{_title} = $rank;
}

sub addCVE
{
	my ($self, $CVE) = @_;
	push(@{$self->{_CVE}}, $CVE);
}

sub getCVEs
{
	my ($self, $CVE) = @_;
	my $output = "";
	foreach my $item (@{$self->{_CVE}})
	{
		$output .= $item.",";
	}

	return substr($output, 0, length($output) -1);

}

sub isVulnerable
{
	my ($self, $CVE) = @_;
	foreach my $item (@{$self->{_CVE}})
	{
		if($item eq $CVE)
		{
			return 1;
		}
	}
	return 0;
}

sub isDOS
{
	my ($self, $CVE) = @_;
	if($self->{_name} =~ m/\/dos\//)
	{
		return 1;
	}
	
	return 0;
}
1;